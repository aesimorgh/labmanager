{% load static %}
<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>{% block title %}پنل کاربری{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{--c-border:#e5e7eb;--c-bg:#fff;--c-muted:#6b7280;--c-active:#0d6efd;}
    body{margin:0;background:#f8fafc;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Tahoma;}
    .container{max-width:1100px;margin-inline:auto;padding:1rem;}
    .header{background:var(--c-bg);border-bottom:1px solid var(--c-border);}
    .brand{display:flex;align-items:center;gap:.75rem;}
    .brand img{height:40px;width:auto;}
    .tabs{background:var(--c-bg);border-bottom:1px solid var(--c-border);position:sticky;top:0;z-index:10;}
    .nav{display:flex;gap:.5rem;list-style:none;margin:0;padding:.25rem 0;}
    .nav a{display:inline-block;padding:.5rem .75rem;border-radius:.5rem;text-decoration:none;color:#111827;}
    .nav a.active{background:rgba(13,110,253,.1);color:var(--c-active);font-weight:600;}
    .card{background:var(--c-bg);border:1px solid var(--c-border);border-radius:.75rem;}
    .card-body{padding:1rem;}
    .alert{padding:.75rem 1rem;border-radius:.5rem;margin-bottom:.5rem;border:1px solid var(--c-border);background:#fff;}
    .alert-success{border-color:#86efac;background:#f0fdf4;}
    .alert-error{border-color:#fca5a5;background:#fef2f2;}
    .small{font-size:.875rem;color:var(--c-muted);}
  </style>

  {% block head_extra %}{% endblock %}
</head>
<body>

<header class="header">
  <div class="container">
    <div class="brand">
      {% if lab_profile and lab_profile.logo %}
        <img src="{{ lab_profile.logo.url }}" alt="لوگو">
      {% endif %}
      <div>
        <strong>{{ lab_profile.lab_name|default:"LabManager" }}</strong><br>
        <span class="small">
          {{ lab_profile.owner_name|default:"" }}{% if lab_profile.iban %} • شبا: {{ lab_profile.iban }}{% endif %}
        </span>
      </div>
    </div>
  </div>
</header>

<div class="tabs">
  <div class="container">
    <ul class="nav" role="tablist">
      <!-- اگر مسیرهایت متفاوت است، فقط همین hrefها را به اسلاگ‌های واقعی پروژه‌ات تغییر بده -->
      <li><a data-key="/dashboard" href="/dashboard/" class="{% if '/dashboard' in request.path or request.path == '/' %}active{% endif %}">داشبورد</a></li>
      <li><a data-key="/orders"    href="/orders/"    class="{% if '/orders'    in request.path %}active{% endif %}">سفارش‌ها</a></li>
      <li><a data-key="/billing"   href="/billing/"   class="{% if '/billing'   in request.path %}active{% endif %}">مالی</a></li>
      <li><a data-key="/settings"  href="/settings/"  class="{% if '/settings'  in request.path %}active{% endif %}">تنظیمات</a></li>
    </ul>
  </div>
</div>

<main class="container" style="padding-block:1rem">
  {% block subtabs %}{% endblock %}

  {% if messages %}
    <div>
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  {% block content %}
    <div class="card"><div class="card-body">
      <p class="small">اسکلت پنل کاربری آماده است. صفحات دیگر می‌توانند از این قالب ارث‌بری کنند.</p>
    </div></div>
  {% endblock %}
</main>

{% block body_extra %}{% endblock %}

<script>
/* فعال‌سازی بصری تب مناسب اگر از سمت سرور ست نشده باشد */
(function(){
  const nav = document.querySelector('.tabs .nav');
  if(!nav) return;
  const links = Array.from(nav.querySelectorAll('a'));

  function setActive(el){
    links.forEach(a => a.classList.remove('active'));
    if(el) el.classList.add('active');
  }

  const hasActive = links.some(a => a.classList.contains('active'));
  if(!hasActive){
    const path = (location && location.pathname) ? location.pathname : '';
    const match = links.find(a => a.dataset.key && path.indexOf(a.dataset.key) !== -1);
    setActive(match || links[0]);
  }
})();
</script>
</body>
</html>


