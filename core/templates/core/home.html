{% load static %}
{% load crispy_forms_tags %}
{% load jformat %}


<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>پنل مدیریت آزمایشگاه</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">

<div class="container my-5">
    <h1 class="mb-4 text-center">پنل مدیریت آزمایشگاه</h1>

    <!-- فرم ثبت بیمار و سفارش جدید -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            ثبت بیمار و سفارش جدید
        </div>
        <div class="card-body">
            <form method="post">
                {% csrf_token %}
                <h5>اطلاعات بیمار</h5>
                <div class="row mb-3">
                    <div class="col">
                        {{ patient_form.first_name|as_crispy_field }}
                    </div>
                    <div class="col">
                        {{ patient_form.last_name|as_crispy_field }}
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col">
                        {{ patient_form.phone|as_crispy_field }}
                    </div>
                    <div class="col">
                        {{ patient_form.email|as_crispy_field }}
                    </div>
                </div>
                <div class="mb-3">
                    {{ patient_form.address|as_crispy_field }}
                </div>

                <h5>اطلاعات سفارش</h5>
                <div class="row mb-3">
                    <div class="col">
                        {{ order_form.doctor|as_crispy_field }}
                    </div>
                    <div class="col">
                        {{ order_form.order_type|as_crispy_field }}
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col">
                        {{ order_form.shade|as_crispy_field }}
                    </div>
                    <div class="col">
                        {{ order_form.price|as_crispy_field }}
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col">
                        {{ order_form.status|as_crispy_field }}
                    </div>
                    <div class="col">
                        {{ order_form.due_date|as_crispy_field }}
                    </div>
                </div>
                <div class="mb-3">
                    {{ order_form.notes|as_crispy_field }}
                </div>

                <button type="submit" class="btn btn-success">ثبت بیمار و سفارش</button>
            </form>
        </div>
    </div>

    <!-- جدول سفارش‌ها -->
    <div class="card">
        <div class="card-header bg-info text-white">
            لیست سفارش‌ها
        </div>
        <div class="card-body table-responsive">
            <table class="table table-bordered table-hover">
                <thead class="table-light">
                    <tr>
                        <th>نام بیمار</th>
                        <th>نام دکتر</th>
                        <th>نوع سفارش</th>
                        <th>قیمت</th>
                        <th>وضعیت</th>
                        <th>تاریخ ثبت</th>
                        <th>تاریخ تحویل</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in orders %}
                    <tr>
                        <td>{{ order.patient.first_name }} {{ order.patient.last_name }}</td>
                        <td>{{ order.doctor }}</td>
                        <td>{{ order.order_type }}</td>
                        <td>{{ order.price }}</td>
                        <td>{{ order.get_status_display }}</td>
                        <td>{{ order.created_at|jformat:"%Y/%m/%d" }}</td>
                        <td>{% if order.due_date %}{{ order.due_date|jformat:"%Y/%m/%d" }}{% endif %}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="text-center">هیچ سفارشی ثبت نشده است.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>











